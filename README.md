# Oberon Kruskal Feedback Edge Set

The agorithm finds the minimum (with minimum weight) set of edges of a linked
non-oriented graph, such that in any cycle of the graph there is at least one
set from the given set.

## Usage

1. Download [Vostok Oberon compiler](https://vostok.oberon.org).
2. Execute `./run.sh` or:
```
ost to-bin 'VinniPuh.Do' vinnipuh -m .
./vinnipuh < 'in.txt' > 'out.txt'
```

## Input

Example of input file:
```
10
1 2 -32  1 3 63   2 3 55  1 4  44  2 4  36
3 4 99   1 5 -26  2 6 22  5 6  73  2 7  83
4 7 65   1 8 40   2 8 26  3 8  51  7 8  70
3 9 4    6 9 65   8 9 81  3 10 67  8 10 22
```

The first number is the number of vertices. Next follow tripples of numbers:
strting vertex of an edge, ending vertex of the edge and weight of the edge.

## Output

The output is first the number of edges in the result set, then the starting
and the ending vertices of the edges.

Example of output file:
```
11 242  2 3 3 8 1 4 1 8 2 4 2 8 8 10 2 6 3 9 1 5 1 2
```

Riga.

January, 2025

by Arthur Yefimov

Latvian State University

# Рассуждения

По существу, необходимо найти наименьшее по суммарному весу множество рёбер данного графа, пересекающее все его циклы. То есть такое множество рёбер, чтобы в каждом цикле графа было бы хотя бы одно ребро из этого множества.

Можно сначала попробовать найти некоторое множество рёбер, каждое из которых образует хотя бы один цикл при добавлении этого ребра в граф. Это наводит на мысль о остовном дереве. Рёбра, не входящие в остовное дерево, обладают тем свойством, что каждое из них будет соединять это дерево с ним же самим, а значит образовывать некоторый обходной путь для уже существующего пути — то есть образовывать цикл.

Но если взять минимальное остовное дерево, то оставшиеся рёбра будут максимально возможными (по весу). Поэтому, наоборот, в самом начале алгоритмиа найдём максимальное (а не минимальное) остовное дерево.

Далее вычтем из множества всех рёбер графа рёбра, входящие в найденное нами максимальное остовное дерево. Такие оставшиеся рёбра будут минимизированы по суммарному весу.

Количество рёбер в остовном дереве всегда равно количеству вершин в графе минус одна, поскольку 1) остовное дерево соединяет все вершины и потому что 2) дерево не может иметь циклов. Пусть в графе n вершин. К первой вершине присоедняется вторая, на это расходуется одно ребро. После этого оставшиеся (n − 2) вершин присоединяются таким же количеством рёбер, поэтому в конце мы получаем (n − 1) рёбер в остовном дереве (по построению).

Чтобы получить максимальное остовное дерево вместо менимального, просто отсортируем массив рёбер по весу в убывающем порядке вместо возрастающего.

В представленном решении используется алгоритм Краскала. Для сортировки рёбер используется алгоритм быстрой сортировки. Для выяснения, к какому дереву леса принадлежит вершина, используется простой способ, при котором в массиве указывается номер дерева каждой вершины. Это приводит к тому, что операция объединия двух деревьев имеет сложность O(n).

В работы алгоритма Краскала, программа отмечает рёбра, относящиеся к максимальному остовному дереву. В конце остаётся только подсчитать суммарный вес неотмеченных рёбер, а затем вывести их в файл.

Получившиеся множество рёбер является наименьшим из возможных по количеству элементов, потому что, если из него убрать одно ребро, немедленно образуется цикл, в котором Винни Пух может заблудится без мёда.

Получившееся множество также является наименьшим по суммарному весу, поскольку это дополнение максимального остовного дерева до полного графа, то есть все максимальные рёбра, которые только можно было убрать из рассмотрения, уже отброшены.

Из этого следует, что алгоритм работает верно при любых входных данных.

Более точное рассуждение:

Пусть в графе n вершин и m рёбер. В результате работы программы всегда получается m − (n − 1) рёбер, поскольку оставшиеся от остовного дерева рёбра составляют именно такое количество.

Предположим, что при каких-либо определённых входных данных наш алгортим выдаёт больше рёбер, чем надо. Например, на одно ребро больше. Значит, правильный ответ должен содержать x = m − (n − 1) − 1 рёбер. В дуплах на соответствующих дорожках Винни Пух спрячет мёд. Значит, y = m − x дупел останется без мёда, так как общее количество дупел равно m.
```
y = m − x =
  = m − (m − (n − 1) − 1) =
  = m − m + n − 1 + 1 =
  = n
```

Следовательно, в графе будет n рёбер, которые не имеют мёда. Так как для соединения всех вершин графа достаточно (n − 1) рёбер, остаётся ещё одно ребро, которое надо куда-то пристроить. Так как это остовное дерево, в результате получается цикл. Следовательно, в графе будет цикл без мёда. А значит, решение с x вершинами неверное. Приходим к противоречию. Ч. т. д.
